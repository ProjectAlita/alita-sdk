name: "SR12 - DateTime Formatting"
description: "Verify datetime formatting in code node with output string format"

state:
  input:
    type: str
  messages:
    type: list
  test_data:
    type: number
    value: '1'
  test_results:
    type: dict

entry_point: code_to_catch_bug_with_new_lines

nodes:
  - id: code_to_catch_bug_with_new_lines
    type: code
    code:
      type: fixed
      value: |-
        from datetime import datetime
        current_date = datetime.now()
        current_time = datetime.now()

        output_string = f"11\n\n Test comment {current_date}{current_time}"
        
        # Validation checks
        checks = {
            "has_prefix": output_string.startswith("11\n\n Test comment"),
            "contains_newlines": "\n\n" in output_string,
            "has_datetime": len(output_string) > len("11\n\n Test comment"),
            "is_string": isinstance(output_string, str),
            "not_empty": len(output_string) > 0
        }
        
        all_passed = all(checks.values())
        
        result = {
            "test_passed": all_passed,
            "formatted_message": output_string,
            "checks": checks,
            "message_length": len(output_string)
        }
        test_results = result
        test_results
    input: []
    output:
      - messages
    structured_output: false
    transition: END
