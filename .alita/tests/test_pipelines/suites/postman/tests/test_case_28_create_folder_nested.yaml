name: "PST28 create folder nested"
priority: High
description: |
  Validates that the create_folder tool successfully creates a folder
  nested inside a parent folder using the parent_path parameter.
  
  Objective: Verify nested folder creation
  
  Expected Behavior:
  - Tool executes successfully
  - Folder is created inside the specified parent
  - Parent-child relationship is established
  - Returns folder ID and confirmation

toolkits:
  - id: ${TOOLKIT_ID}
    name: ${TOOLKIT_NAME}

state:
  tool_result:
    type: dict
  test_results:
    type: dict
  folder_name:
    type: str
    value: "Nested Folder"
  parent_path:
    type: str
    value: ${TEST_FOLDER_PATH}
entry_point: invoke_create_folder

nodes:
  - id: invoke_create_folder
    type: toolkit
    toolkit_name: ${TOOLKIT_NAME}
    tool: create_folder
    input:
      - folder_name
      - parent_path
    input_mapping:
      name:
        type: variable
        value: folder_name
      parent_path:
        type: variable
        value: parent_path
    output:

      - tool_result
    structured_output: true
    transition: process_results

  - id: process_results
    type: llm
    model: gpt-4o-2024-11-20
    input:
      - tool_result
    input_mapping:
      system:
        type: fixed
        value: "You are a quality assurance validator."
      task:
        type: fstring
        value: |
          Analyze the output from the 'create_folder' tool for nested folder creation.
          
          Tool Result: {tool_result}
          
          This test validates that create_folder creates a nested folder.
          
          Perform the following checks:
          1. Confirm the tool executed successfully.
          2. Verify the folder was created inside the parent folder.
          3. Check for folder ID and parent relationship.
          4. Validate the nested structure was established.
          
          Return a JSON object named test_results with the following structure:
          
          {{
            "test_passed": boolean (true if nested folder was created successfully),
            "summary": "brief description of outcome",
            "error": "error details if failed, null if passed"
          }}
          
          Return **ONLY** the JSON object. No markdown formatting, no additional text.
      chat_history:
        type: fixed
        value: []
    output:
      - test_results
    structured_output_dict:
      test_results: "dict"
    transition: END
