name: "PST56 move request happy path"
priority: Critical
description: |
  Validates that the move_request tool successfully moves a request to a
  different folder within the collection.
  
  Objective: Verify request move functionality
  
  Expected Behavior:
  - Tool executes successfully
  - Request is moved to the target folder
  - Request structure is updated
  - Returns confirmation of the move

toolkits:
  - id: ${TOOLKIT_ID}
    name: ${TOOLKIT_NAME}

state:
  tool_result:
    type: dict
  test_results:
    type: dict
  request_path:
    type: str
    value: ${TEST_REQUEST_PATH}
  target_folder_path:
    type: str
    value: ${TARGET_FOLDER_PATH}
entry_point: invoke_move_request

nodes:
  - id: invoke_move_request
    type: toolkit
    toolkit_name: ${TOOLKIT_NAME}
    tool: move_request
    input:
      - request_path
      - target_folder_path
    input_mapping:
      request_path:
        type: variable
        value: request_path
      target_folder_path:
        type: variable
        value: target_folder_path
    output:

      - tool_result
    structured_output: true
    transition: process_results

  - id: process_results
    type: llm
    model: gpt-4o-2024-11-20
    input:
      - tool_result
    input_mapping:
      system:
        type: fixed
        value: "You are a quality assurance validator."
      task:
        type: fstring
        value: |
          Analyze the output from the 'move_request' tool.
          
          Tool Result: {tool_result}
          
          This test validates that move_request moves a request to a different folder.
          
          Perform the following checks:
          1. Confirm the tool executed successfully.
          2. Verify the result indicates request was moved.
          3. Check for success confirmation or updated collection structure.
          4. Validate the request is now in the target folder.
          
          Return a JSON object named test_results with the following structure:
          
          {{
            "test_passed": boolean (true if request was moved successfully),
            "summary": "brief description of outcome",
            "error": "error details if failed, null if passed"
          }}
          
          Return **ONLY** the JSON object. No markdown formatting, no additional text.
      chat_history:
        type: fixed
        value: []
    output:
      - test_results
    structured_output_dict:
      test_results: "dict"
    transition: END
