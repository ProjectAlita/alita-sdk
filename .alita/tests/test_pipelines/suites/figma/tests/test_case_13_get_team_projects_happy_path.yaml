name: "FIG13 - Get Team Projects: Happy Path"
description: "Verify get_team_projects retrieves all projects for a team"

toolkits:
  - id: ${FIGMA_TOOLKIT_ID}
    name: ${FIGMA_TOOLKIT_NAME}

state:
  team_id:
    type: str
    value: '1600893205947708770'
  test_results:
    type: dict
  tool_result:
    type: dict
entry_point: invoke_get_team_projects
nodes:
  - id: invoke_get_team_projects
    type: toolkit
    input:
      - team_id
    input_mapping:
      team_id:
        type: variable
        value: team_id
    output:
      - tool_result
    structured_output: true
    tool: get_team_projects
    toolkit_name: figma-testing
    transition: validate_projects
  - id: validate_projects
    type: llm
    input:
      - tool_result
      - team_id
    input_mapping:
      chat_history:
        type: fixed
        value: []
      system:
        type: fixed
        value: You are a quality assurance validator for Figma API team projects testing.
      task:
        type: fstring
        value: |-
          Analyze the output from 'get_team_projects' and validate the projects list.

          Tool Output: {tool_result}
          Team ID Used: {team_id}

          Validation Criteria:
          1. Tool Execution: Confirm the tool executed successfully
          2. Response Structure: Verify the response contains:
             - projects (array of project objects)
             - Each project should have:
               - id (project ID)
               - name (project name)
          3. Array Format: Projects should be in an array (can be empty for new teams)
          4. No Errors: Response should not contain error fields
          5. id has to be 547513795 and name Team project

          Note: Teams may have zero projects, which is valid.

          Return a JSON object named test_results with this EXACT structure:
          {
            "test_passed": boolean,
            "tool_executed": boolean,
            "operation_succeeded": boolean,
            "project_count": integer,
            "has_valid_structure": boolean,
            "error": string or null,
            "message_snippet": "Brief summary of team projects retrieved"
          }

          IMPORTANT: Return ONLY the test_results JSON object, no additional text.
    model: gpt-4o
    output:
      - test_results
    structured_output_dict:
      test_results: dict
    transition: END