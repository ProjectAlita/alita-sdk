# GitHub Toolkit Negative Tests - Conflicts Category
# Run with: alita agent execute-test-cases --suite github_toolkit_negative_conflicts

name: github_toolkit_negative_conflicts
description: GitHub toolkit conflict/duplicate error handling tests

env_mapping:
  toolkit_config: ${GIT_CONFIG_PATH:../../../tool_configs/git-config.json}
  access_token: ${GIT_TOOL_ACCESS_TOKEN}
  repository: ${GITHUB_TEST_REPO:ProjectAlita/elitea-testing}
  base_branch: ${GITHUB_BASE_BRANCH:main}

setup:
  - name: Setup GitHub Configuration
    type: configuration
    config:
      config_type: github
      alita_title: ${GITHUB_SECRET_NAME:github}
      data:
        access_token: ${GIT_TOOL_ACCESS_TOKEN}
        base_url: "https://api.github.com"

  - name: Create GitHub Toolkit
    type: toolkit
    action: create_or_update
    config:
      config_file: ../configs/git-config.json
      toolkit_type: github
      overrides:
        github_configuration:
          private: true
          alita_title: ${GITHUB_SECRET_NAME:github}
        repository: ${GITHUB_TEST_REPO:ProjectAlita/elitea-testing}
        active_branch: ${GITHUB_BASE_BRANCH:main}
        base_branch: ${GITHUB_BASE_BRANCH:main}
      toolkit_name: ${GITHUB_TOOLKIT_NAME:testing-negative-conflicts}
    save_to_env:
      - key: GITHUB_TOOLKIT_ID
        value: $.id
      - key: GITHUB_TOOLKIT_NAME
        value: $.name

execution:
  test_directory: tests/conflicts
  order:
    - test_neg_21_*.yaml
    - test_neg_22_*.yaml
    - test_neg_24_*.yaml
    - test_neg_25_*.yaml

  substitutions:
    GITHUB_TOOLKIT_ID: ${GITHUB_TOOLKIT_ID}
    GITHUB_TOOLKIT_NAME: ${GITHUB_TOOLKIT_NAME}

  settings:
    timeout: 60
    parallel: 1
    stop_on_failure: false

cleanup:
  - name: Delete Test Toolkit
    type: toolkit
    config:
      toolkit_id: ${GITHUB_TOOLKIT_ID}
    continue_on_error: true

metadata:
  category: conflicts
  parent_suite: github_toolkit_negative
