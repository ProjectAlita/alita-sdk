# Get Wiki Page with Image Processing

## Objective

Verify that the `get_wiki_page` tool correctly retrieves a wiki page containing an embedded image and processes the image, returning a meaningful text description instead of raw attachment URLs.

## Test Data Configuration

### Settings

| Parameter | Value | Description                        |
|-----------|-------|------------------------------------|
| **Organization URL** | `${ADO_ORGANIZATION_URL}` | Azure DevOps organization URL      |
| **Project** | `${ADO_PROJECT}` | Azure DevOps project name          |
| **Token** | `${ADO_TOKEN}` | Azure DevOps personal access token |
| **Wiki Identifier** | `TestProject.wiki` | Wiki name or ID                    |
| **Page ID** | `54` | Wiki page ID to retrive            |
| **Tool** | `get_wiki_page` | ADO wiki tool to execute           |

## Config

path: .alita\tool_configs\ado-wiki-config.json
generateTestData: false

## Pre-requisites

- Azure DevOps organization and project exist and are accessible
- Valid Azure DevOps personal access token with wiki read permissions
- Wiki with the specified identifier exists
- Wiki page with ID 54 exists and contains an image with two laptops on a wooden desk
- LLM is configured for image description generation

---

## Part A: Retrieve Wiki Page with Image

### Objective

Verify that the `get_wiki_page` tool retrieves the wiki page content and processes the embedded image successfully.

### Step 1: Execute get_wiki_page Tool

Use the `get_wiki_page` tool to retrieve the wiki page with the following parameters:
wiki id - `TestProject.wiki`, page id - `54` and include content - `true`

Save the returned content to `{{WIKI_PAGE_CONTENT}}`.

**Expectation:** The tool executes without errors and returns the wiki page content including processed image descriptions.

### Step 2: Verify No Raw Attachment URLs

Examine `{{WIKI_PAGE_CONTENT}}` for any raw attachment URLs.

**Expectation:** The content should NOT contain any `/.attachments/` paths. All image attachment URLs should have been replaced with text descriptions.

---

## Part B: Verify Image Description Quality

### Objective

Verify that the image description generated by the LLM is meaningful and accurately describes the image content.

### Step 3: Check for Relevant Keywords

Examine `{{WIKI_PAGE_CONTENT}}` for keywords that describe the known image content (two laptops on a wooden desk in a workspace).

**Expectation:** The content should contain at least one of the following relevant keywords:
- `laptop` or `laptops`
- `computer`
- `desk` or `wooden`
- `workspace` or `office`
- `silver` or `black`
- `screen`

### Step 4: Verify Description Context

Examine `{{WIKI_PAGE_CONTENT}}` to verify the image description provides meaningful context.

**Expectation:** The description should convey information about:
- The presence of laptop(s) or computer device(s)
- A workspace or desk setting
- Visual elements like colors or objects in the scene

---

## Part C: Verify Content Integrity

### Objective

Verify that non-image content in the wiki page is preserved unchanged after image processing.

### Step 5: Check Markdown Structure

Examine `{{WIKI_PAGE_CONTENT}}` for proper markdown formatting.

**Expectation:** 
- The content should be valid markdown
- Image references should use markdown image syntax `![alt](description)` with description text instead of URLs
- Any headings, paragraphs, or other markdown elements should be preserved
